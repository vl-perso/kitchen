!function(n){var e={};function t(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return n[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,e){if(1&e&&(n=t(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var a in n)t.d(r,a,function(e){return n[e]}.bind(null,a));return r},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t(t.s=10)}([function(n,e,t){"use strict";t.d(e,"c",(function(){return r})),t.d(e,"b",(function(){return a})),t.d(e,"d",(function(){return o})),t.d(e,"a",(function(){return i}));var r=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch("https://keystone-blog-enrichment.herokuapp.com/admin/api",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({variables:e,query:n})}).then((function(n){return n.json()})).catch((function(n){return console.log(n)}))},a=function(){return r("\n    {\n      authenticatedUser {\n        id\n        name\n        bookmarks {\n          id\n          path\n          name\n        }\n      }\n    }\n  ").then((function(n){return!(!n||!n.data)&&n.data.authenticatedUser}))},o=function(n){return n.every((function(n){return""!==n.value}))},i=function(n,e){return r(n,e).then((function(n){var e=n.data;return e?e.allPages?e.allPages[0]||{}:e.allComments?{comments:e.allComments}:e.addComment?e.addComment:e.clap?e.clap:e:{}}))}},,,function(n,e){n.exports='<svg focusable="false" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" style="max-width:200px" fill="none" viewBox="0 0 32 32"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M2 21.095V2h17v6"></path><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M2 2l10 6v22L2 24V2zM16 12h14M19 16v8h-7M24 6l6 6-6 6"></path></svg>'},,,,,,,function(n,e,t){"use strict";t.r(e);var r=t(0),a=(t(11),t(3)),o=t.n(a),i="\nmutation Login ($email: String!, $password: String!) {\n  authenticateUserWithPassword(email: $email, password: $password) {\n    token\n  }\n}",s=window.document.querySelector("#keystone-login");if(s){var l=document.createElement("form");l.innerHTML='\n    <div class="l-stack">\n      <div class="l-form-row">\n        <label>Email</label>\n        <input type="text" name="email" class="input" />\n      </div>\n      <div class="l-form-row">\n        <label>Password</label>\n        <input type="password" name="password" class="input" />\n      </div>\n      <div class="l-form-row">\n        <div class="l-login-button">\n          <button type="submit" class="button">\n            Login\n          </button> <span>New User? <a href="/sign-up">Sign up</a></span>\n        </div>\n      </div>\n    </div>\n      ',l.classList.add("js-login-form"),l.addEventListener("submit",(function(n){n.preventDefault();var e=n.target.elements,t=e.email,a=e.password;Object(r.d)([t,a])?Object(r.c)(i,{email:t.value,password:a.value}).then((function(n){var e=n.errors;e&&e.length?(console.log(e),alert("Email or Password is incorrect.")):window.location="/"})).catch((function(n){console.log(n),alert("Error during login")})):alert("Email and Password required.")})),s.appendChild(l)}var u=window.document.querySelector("#keystone-sign-up");if(u){var c=document.createElement("form");c.innerHTML='\n    <div class="l-stack">\n    <div class="l-form-row">\n      <label>Name</label>\n      <input type="text" name="name" class="input" />\n    </div>\n    <div class="l-form-row">\n      <label>Email</label>\n      <input type="text" name="email" class="input" />\n    </div>\n      <div class="l-form-row">\n        <label>Password <small>(must be at least 8 characters)</small></label>\n        <input type="password"  autocomplete="new-password"  name="password" class="input" />\n      </div>\n      <div class="l-form-row">\n        <label>Repeat Password</label>\n        <input type="password" name="password-repeat" class="input" />\n      </div>\n      <div class="l-form-row">\n        <button type="submit" class="button">\n          Sign-up\n        </button>\n      </div>\n    </div>\n      ',c.classList.add("js-sign-up-form"),c.addEventListener("submit",(function(n){n.preventDefault();var e=n.target.elements,t=e.name,a=e.email,o=e.password,s=e["password-repeat"];Object(r.d)([t,a,o,s])?o.value===s.value?Object(r.c)("\nmutation CreateUser ($name: String!, $email: String!, $password: String!) {\n  createUser(data: {name: $name, email: $email, password: $password}) {\n    id\n  }\n}",{name:t.value,email:a.value,password:o.value}).then((function(){Object(r.c)(i,{email:a.value,password:o.value}).then((function(n){var e=n.errors;e&&e.length?(console.log(e),alert("Error during login")):window.location="/"})).catch((function(n){console.log(n),alert("Error during login")}))})).catch((function(n){console.log(n),alert("Error creating new user")})):alert("Passwords must match."):alert("All fields are required.")})),u.appendChild(c)}var d=function(n){return function(e){n&&(e.preventDefault(),Object(r.c)("mutation {\n  unauthenticateUser {\n    success\n  }\n}").then((function(n){n.data.unauthenticateUser.success&&(window.location="/")})))}},p=document.getElementById("keystone-nav-login");p&&Object(r.b)().then((function(n){null!==n&&(!1===n?p.innerHTML="":(d(n),p.addEventListener("click",d(n)),p.innerHTML="Logout ".concat(o.a)))})).catch((function(n){console.log(n)}))},function(n,e){n.exports='<svg focusable="false" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" style="max-width:200px" fill="none" viewBox="0 0 21 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M20 12H9M12 9l-3 3 3 3"></path><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-width="2" d="M17 16v5a2 2 0 01-2 2H3a2 2 0 01-2-2V3a2 2 0 012-2h12a2 2 0 012 2v5"></path></svg>'}]);
//# sourceMappingURL=keystone-login.js.map