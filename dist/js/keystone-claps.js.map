{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./site/src/js/util.js","webpack:///./site/_includes/partials/icons/clap.svg","webpack:///./site/src/js/keystone-claps.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","graphql","query","variables","fetch","process","method","headers","credentials","body","JSON","stringify","then","result","json","error","console","log","getAuthenticatedUser","data","authenticatedUser","validateInputs","fields","every","field","fetchData","allPages","allComments","comments","addComment","clap","clapsTarget","window","document","querySelector","event","preventDefault","form","target","pageTitle","title","path","elements","claps","updateClaps","getElementById","innerHTML","location","pathname","createElement","clapIcon","classList","add","addEventListener","appendChild"],"mappings":"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","file":"keystone-claps.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n","export const graphql = (query, variables = {}) => {\n  return fetch(process.env.KEYSTONE_API, {\n    method: `POST`,\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify({\n      variables,\n      query\n    })\n  })\n    .then(result => result.json())\n    .catch(error => console.log(error));\n};\nexport const getAuthenticatedUser = () =>\n  graphql(`\n    {\n      authenticatedUser {\n        id\n        name\n        bookmarks {\n          id\n          path\n          name\n        }\n      }\n    }\n  `).then(result => {\n    if (result && result.data) {\n      const {\n        data: { authenticatedUser }\n      } = result;\n      return authenticatedUser;\n    }\n    return false;\n  });\n\nexport const validateInputs = fields =>\n  fields.every(field => field.value !== \"\");\nexport const fetchData = (query, data) => {\n  return graphql(query, data).then(({ data }) => {\n    if (data) {\n      if (data.allPages) {\n        return data.allPages[0] || {};\n      } else if (data.allComments) {\n        return { comments: data.allComments };\n      } else if (data.addComment) {\n        return data.addComment;\n      } else if (data.clap) {\n        return data.clap;\n      }\n      // unknown data\n      return data;\n    }\n    return {};\n  });\n};\n","module.exports = \"<svg focusable=\\\"false\\\" aria-hidden=\\\"true\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" style=\\\"max-width:200px\\\" viewBox=\\\"0 0 64 64\\\"><path d=\\\"M54.255 25.75c-2.854-1.952-4.644-4.562-6.075-8.581-.532-1.494-1.859-2.46-3.381-2.46-1.636 0-3.132 1.055-4.104 2.894a8.582 8.582 0 00-.986 3.28c-1.008-1.838-3.056-2.229-4.027-.922 0 0-7.986-6.071-10.71-8.004-3.62-2.566-8.415.276-8.295 3.211-4.571-2.478-9.589 1.897-8.043 6.482-1.768-.324-6.29 4.363-1.536 7.963-3.293.338-4.572 5.494-.745 7.841 0 0 .018.713.069 1.063-2.522.766-3.392 5.534-.953 7.039 0 0 17.59 11.232 23.645 14.611 3.29 1.836 8.955 2.557 14.002.918 4.901-.508 9.059-3.106 12.4-7.736 9.195-12.742 1.911-25.429-1.261-27.599m-1.077 26.357c-3.829 5.38-9.328 5.938-13.536 5.938-6.869 0-11.065-3.293-11.065-3.293L9.725 40.676c-3.569-2.464-1.42-6.39 1.084-6.318l14.997 10.219 1.846.115S14.257 35.076 9.92 31.691c-2.532-1.976-1.7-5.75 1.578-6.5l18.756 13.464 1.844.115-20.035-15.538c-4.233-3.094.015-8.928 4.119-5.957 4.733 3.426 18.972 14.285 18.972 14.285l1.846.116-18.745-15.527c-.162-2.396 3.025-4.479 5.573-2.573 5.124 3.833 20.504 15.32 20.504 15.32-.396-1.109-.594-1.943-.594-1.943s-2.922-4.858-1.339-8.395c1.39-3.102 4.202-2.598 4.769-.931 1.507 4.438 3.068 7.072 6.191 9.292 3.988 2.835 8.066 13.605-.181 25.188\\\"></path><path d=\\\"M46.041 2.889L37.431 2l2.938 12.26zM53.165 5.264L48.79 15.457l10.205-2.734zM29.111 3.549l-6.21 5.133 8.944 5.828z\\\"></path></svg>\"","import { fetchData } from \"./util\";\r\nimport clapIcon from \"../../_includes/partials/icons/clap.svg\";\r\n\r\nconst clapsTarget = window.document.querySelector(`#keystone-claps-form`);\r\n\r\nconst GET_CLAPS = `\r\n  query GetClaps($path: String!) {\r\n    allPages (where: { path: $path  }) {\r\n      id, \r\n      claps,\r\n      path\r\n    }\r\n  }`;\r\n\r\nconst CLAP = `\r\n  mutation Clap($path: String!, $pageTitle: String) {\r\n      clap(path: $path, pageTitle: $pageTitle) {\r\n        id,\r\n        claps\r\n    }\r\n  }`;\r\n\r\nconst clap = event => {\r\n  event.preventDefault();\r\n  const form = event.target;\r\n  const pageTitle = document.title;\r\n  const { path } = form.elements;\r\n  if (path) {\r\n    fetchData(CLAP, {\r\n      path: path.value,\r\n      pageTitle\r\n    }).then(({ claps }) => {\r\n      updateClaps(claps);\r\n    });\r\n  }\r\n};\r\nconst createForm = ({ claps }) => {\r\n  const form = document.createElement(\"form\");\r\n  const path = window.location.pathname;\r\n\r\n  form.innerHTML = `\r\n      <input type=\"hidden\" name=\"path\" value=\"${path}\"/>\r\n      <div class=\"show-some-love\">\r\n        <button type=\"submit\" class=\"clap-button\">\r\n          <div class=\"heart heart-1\"></div>\r\n          <div class=\"heart heart-2\"></div>\r\n          <div class=\"heart heart-3\"></div>\r\n          <div class=\"heart heart-4\"></div>\r\n          <div class=\"heart heart-5\"></div>\r\n          ${clapIcon}\r\n          <span id=\"keystone-claps\">${claps || 0}</span>\r\n        </button>\r\n        <p>Show some love!</p>\r\n      </div>\r\n      `;\r\n  form.classList.add(\"js-clap-form\");\r\n  form.addEventListener(\"submit\", clap);\r\n  clapsTarget.appendChild(form);\r\n};\r\n\r\nconst updateClaps = claps => {\r\n  document.getElementById(\"keystone-claps\").innerHTML = `<span>${claps ||\r\n    0}</span>`;\r\n};\r\n\r\nif (clapsTarget) {\r\n  const path = window.location.pathname;\r\n  fetchData(GET_CLAPS, { path }).then(createForm);\r\n}\r\n"],"sourceRoot":""}